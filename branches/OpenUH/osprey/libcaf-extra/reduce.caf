
      module caf_reduction_types
        ! element types
        integer, parameter :: CAF_UNKNOWN   = 0
        integer, parameter :: CAF_INT1      = 1
        integer, parameter :: CAF_INT2      = 2
        integer, parameter :: CAF_INT4      = 3
        integer, parameter :: CAF_INT8      = 4
        integer, parameter :: CAF_REAL4     = 5
        integer, parameter :: CAF_REAL8     = 6
        integer, parameter :: CAF_REAL16    = 7
        integer, parameter :: CAF_COMPLEX4  = 8
        integer, parameter :: CAF_COMPLEX8  = 9
        integer, parameter :: CAF_COMPLEX16 = 10
        integer, parameter :: CAF_LOGICAL1  = 11
        integer, parameter :: CAF_LOGICAL2  = 12
        integer, parameter :: CAF_LOGICAL4  = 13
        integer, parameter :: CAF_LOGICAL8  = 14
        integer, parameter :: CAF_CHAR      = 15

        ! operator types
        integer, parameter :: CAF_SUM       = 1
        integer, parameter :: CAF_MIN       = 2
        integer, parameter :: CAF_MAX       = 3
        integer, parameter :: CAF_PROD      = 4
      end module caf_reduction_types


        !-------------------------------------------------
        ! Reduction routines for CO_SUM
        !-------------------------------------------------

        subroutine sum_reduce_int1(result, val, sz)
            integer, value :: sz
            integer (kind=1) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_int1

        subroutine sum_reduce_int2(result, val, sz)
            integer, value :: sz
            integer (kind=2) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_int2

        subroutine sum_reduce_int4(result, val, sz)
            integer, value :: sz
            integer (kind=4) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_int4

        subroutine sum_reduce_int8(result, val, sz)
            integer, value :: sz
            integer (kind=8) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_int8

        subroutine sum_reduce_real4(result, val, sz)
            integer, value :: sz
            real (kind=4) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_real4

        subroutine sum_reduce_real8(result, val, sz)
            integer, value :: sz
            real (kind=8) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_real8

        subroutine sum_reduce_complex4(result, val, sz)
            integer, value :: sz
            complex (kind=4) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_complex4

        subroutine sum_reduce_complex8(result, val, sz)
            integer, value :: sz
            complex (kind=8) :: result(sz), val(sz)

            result(:) = result(:) + val(:)
        end subroutine sum_reduce_complex8

        !-------------------------------------------------
        ! Reduction routines for CO_MAX
        !-------------------------------------------------

        subroutine max_reduce_int1(result, val, sz)
            integer, value :: sz
            integer (kind=1) :: result(sz), val(sz)

            result(:) = max(result(:), val(:))
        end subroutine max_reduce_int1

        subroutine max_reduce_int2(result, val, sz)
            integer, value :: sz
            integer (kind=2) :: result(sz), val(sz)

            result(:) = max(result(:), val(:))
        end subroutine max_reduce_int2

        subroutine max_reduce_int4(result, val, sz)
            integer, value :: sz
            integer (kind=4) :: result(sz), val(sz)

            result(:) = max(result(:), val(:))
        end subroutine max_reduce_int4

        subroutine max_reduce_int8(result, val, sz)
            integer, value :: sz
            integer (kind=8) :: result(sz), val(sz)

            result(:) = max(result(:), val(:))
        end subroutine max_reduce_int8

        subroutine max_reduce_real4(result, val, sz)
            integer, value :: sz
            real (kind=4) :: result(sz), val(sz)

            result(:) = max(result(:), val(:))
        end subroutine max_reduce_real4

        subroutine max_reduce_real8(result, val, sz)
            integer, value :: sz
            real (kind=8) :: result(sz), val(sz)

            result(:) = max(result(:), val(:))
        end subroutine max_reduce_real8

        subroutine max_reduce_char(result, val, sz)
            integer, value :: sz
            character (len=*) :: result(sz), val(sz)

            integer :: i

            do i=1,sz
              if (result(i) < val(i)) then
                  result(i) = val(i)
              end if
            end do
        end subroutine max_reduce_char

        !-------------------------------------------------
        ! Reduction routines for CO_MIN
        !-------------------------------------------------

        subroutine min_reduce_int1(result, val, sz)
            integer, value :: sz
            integer (kind=1) :: result(sz), val(sz)

            result(:) = min(result(:), val(:))
        end subroutine min_reduce_int1

        subroutine min_reduce_int2(result, val, sz)
            integer, value :: sz
            integer (kind=2) :: result(sz), val(sz)

            result(:) = min(result(:), val(:))
        end subroutine min_reduce_int2

        subroutine min_reduce_int4(result, val, sz)
            integer, value :: sz
            integer (kind=4) :: result(sz), val(sz)

            result(:) = min(result(:), val(:))
        end subroutine min_reduce_int4

        subroutine min_reduce_int8(result, val, sz)
            integer, value :: sz
            integer (kind=8) :: result(sz), val(sz)

            result(:) = min(result(:), val(:))
        end subroutine min_reduce_int8

        subroutine min_reduce_real4(result, val, sz)
            integer, value :: sz
            real (kind=4) :: result(sz), val(sz)

            result(:) = min(result(:), val(:))
        end subroutine min_reduce_real4

        subroutine min_reduce_real8(result, val, sz)
            integer, value :: sz
            real (kind=8) :: result(sz), val(sz)

            result(:) = min(result(:), val(:))
        end subroutine min_reduce_real8

        subroutine min_reduce_char(result, val, sz)
            integer, value :: sz
            character (len=*) :: result(sz), val(sz)

            integer :: i

            do i=1,sz
              if (result(i) > val(i)) then
                  result(i) = val(i)
              end if
            end do
        end subroutine min_reduce_char

        !-------------------------------------------------
        ! Reduction routines for CO_PRODUCT
        !-------------------------------------------------

        subroutine prod_reduce_int1(result, val, sz)
            integer, value :: sz
            integer (kind=1) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_int1

        subroutine prod_reduce_int2(result, val, sz)
            integer, value :: sz
            integer (kind=2) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_int2

        subroutine prod_reduce_int4(result, val, sz)
            integer, value :: sz
            integer (kind=4) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_int4

        subroutine prod_reduce_int8(result, val, sz)
            integer, value :: sz
            integer (kind=8) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_int8

        subroutine prod_reduce_real4(result, val, sz)
            integer, value :: sz
            real (kind=4) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_real4

        subroutine prod_reduce_real8(result, val, sz)
            integer, value :: sz
            real (kind=8) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_real8

        subroutine prod_reduce_complex4(result, val, sz)
            integer, value :: sz
            complex (kind=4) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_complex4

        subroutine prod_reduce_complex8(result, val, sz)
            integer, value :: sz
            complex (kind=8) :: result(sz), val(sz)

            result(:) = result(:) * val(:)
        end subroutine prod_reduce_complex8



!      !----------------------------------------------------
!      ! reduction wrapper logic - INT1
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_INT1_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source
!          integer (kind=1), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_INT1, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_INT1, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_INT1, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_INT1, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_0
!
!      subroutine CO_REDUCE_PREDEF_INT1_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:)
!          integer (kind=1), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_1
!
!      subroutine CO_REDUCE_PREDEF_INT1_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:,:)
!          integer (kind=1), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_2
!
!      subroutine CO_REDUCE_PREDEF_INT1_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:,:,:)
!          integer (kind=1), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_3
!
!      subroutine CO_REDUCE_PREDEF_INT1_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:,:,:,:)
!          integer (kind=1), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_4
!
!      subroutine CO_REDUCE_PREDEF_INT1_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:,:,:,:,:)
!          integer (kind=1), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_5
!
!      subroutine CO_REDUCE_PREDEF_INT1_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:,:,:,:,:,:)
!          integer (kind=1), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_6
!
!      subroutine CO_REDUCE_PREDEF_INT1_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=1) :: source(:,:,:,:,:,:,:)
!          integer (kind=1), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=1), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT1, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT1, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT1, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT1_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - INT2
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_INT2_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source
!          integer (kind=2), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_INT2, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_INT2, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_INT2, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_INT2, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_0
!
!      subroutine CO_REDUCE_PREDEF_INT2_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:)
!          integer (kind=2), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_1
!
!      subroutine CO_REDUCE_PREDEF_INT2_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:,:)
!          integer (kind=2), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_2
!
!      subroutine CO_REDUCE_PREDEF_INT2_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:,:,:)
!          integer (kind=2), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_3
!
!      subroutine CO_REDUCE_PREDEF_INT2_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:,:,:,:)
!          integer (kind=2), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_4
!
!      subroutine CO_REDUCE_PREDEF_INT2_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:,:,:,:,:)
!          integer (kind=2), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_5
!
!      subroutine CO_REDUCE_PREDEF_INT2_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:,:,:,:,:,:)
!          integer (kind=2), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_6
!
!      subroutine CO_REDUCE_PREDEF_INT2_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=2) :: source(:,:,:,:,:,:,:)
!          integer (kind=2), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=2), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT2, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT2, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT2, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT2_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - INT4
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_INT4_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source
!          integer (kind=4), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_INT4, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_INT4, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_INT4, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_INT4, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_0
!
!      subroutine CO_REDUCE_PREDEF_INT4_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:)
!          integer (kind=4), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_1
!
!      subroutine CO_REDUCE_PREDEF_INT4_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:,:)
!          integer (kind=4), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_2
!
!      subroutine CO_REDUCE_PREDEF_INT4_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:,:,:)
!          integer (kind=4), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_3
!
!      subroutine CO_REDUCE_PREDEF_INT4_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:,:,:,:)
!          integer (kind=4), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_4
!
!      subroutine CO_REDUCE_PREDEF_INT4_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:,:,:,:,:)
!          integer (kind=4), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_5
!
!      subroutine CO_REDUCE_PREDEF_INT4_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:,:,:,:,:,:)
!          integer (kind=4), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_6
!
!      subroutine CO_REDUCE_PREDEF_INT4_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=4) :: source(:,:,:,:,:,:,:)
!          integer (kind=4), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT4_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - INT8
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_INT8_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source
!          integer (kind=8), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_INT8, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_INT8, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_INT8, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_INT8, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_0
!
!      subroutine CO_REDUCE_PREDEF_INT8_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:)
!          integer (kind=8), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_1
!
!      subroutine CO_REDUCE_PREDEF_INT8_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:,:)
!          integer (kind=8), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_2
!
!      subroutine CO_REDUCE_PREDEF_INT8_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:,:,:)
!          integer (kind=8), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_3
!
!      subroutine CO_REDUCE_PREDEF_INT8_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:,:,:,:)
!          integer (kind=8), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_4
!
!      subroutine CO_REDUCE_PREDEF_INT8_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:,:,:,:,:)
!          integer (kind=8), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_5
!
!      subroutine CO_REDUCE_PREDEF_INT8_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:,:,:,:,:,:)
!          integer (kind=8), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_6
!
!      subroutine CO_REDUCE_PREDEF_INT8_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          integer (kind=8) :: source(:,:,:,:,:,:,:)
!          integer (kind=8), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          integer (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_INT8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_INT8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_INT8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_INT8_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - REAL4
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_REAL4_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source
!          real (kind=4), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_REAL4, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_REAL4, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_REAL4, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_REAL4, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_0
!
!      subroutine CO_REDUCE_PREDEF_REAL4_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:)
!          real (kind=4), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_1
!
!      subroutine CO_REDUCE_PREDEF_REAL4_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:,:)
!          real (kind=4), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_2
!
!      subroutine CO_REDUCE_PREDEF_REAL4_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:,:,:)
!          real (kind=4), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_3
!
!      subroutine CO_REDUCE_PREDEF_REAL4_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:,:,:,:)
!          real (kind=4), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_4
!
!      subroutine CO_REDUCE_PREDEF_REAL4_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:,:,:,:,:)
!          real (kind=4), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_5
!
!      subroutine CO_REDUCE_PREDEF_REAL4_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:,:,:,:,:,:)
!          real (kind=4), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_6
!
!      subroutine CO_REDUCE_PREDEF_REAL4_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=4) :: source(:,:,:,:,:,:,:)
!          real (kind=4), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL4_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - REAL8
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_REAL8_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source
!          real (kind=8), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_REAL8, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_REAL8, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_REAL8, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_REAL8, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_0
!
!      subroutine CO_REDUCE_PREDEF_REAL8_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:)
!          real (kind=8), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_1
!
!      subroutine CO_REDUCE_PREDEF_REAL8_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:,:)
!          real (kind=8), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_2
!
!      subroutine CO_REDUCE_PREDEF_REAL8_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:,:,:)
!          real (kind=8), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_3
!
!      subroutine CO_REDUCE_PREDEF_REAL8_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:,:,:,:)
!          real (kind=8), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_4
!
!      subroutine CO_REDUCE_PREDEF_REAL8_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:,:,:,:,:)
!          real (kind=8), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_5
!
!      subroutine CO_REDUCE_PREDEF_REAL8_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:,:,:,:,:,:)
!          real (kind=8), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_6
!
!      subroutine CO_REDUCE_PREDEF_REAL8_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          real (kind=8) :: source(:,:,:,:,:,:,:)
!          real (kind=8), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          real (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_REAL8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_REAL8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_REAL8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_REAL8_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - COMPLEX4
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source
!          complex (kind=4), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_COMPLEX4, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_COMPLEX4, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_COMPLEX4, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_COMPLEX4, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_0
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:)
!          complex (kind=4), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_1
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:,:)
!          complex (kind=4), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_2
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:,:,:)
!          complex (kind=4), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_3
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:,:,:,:)
!          complex (kind=4), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_4
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:,:,:,:,:)
!          complex (kind=4), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_5
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:,:,:,:,:,:)
!          complex (kind=4), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_6
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX4_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=4) :: source(:,:,:,:,:,:,:)
!          complex (kind=4), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX4, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX4, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX4, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX4_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - COMPLEX8
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source
!          complex (kind=8), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, 0, &
!                                              CAF_COMPLEX8, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, 0, &
!                                              CAF_COMPLEX8, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            0, CAF_COMPLEX8, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            0, CAF_COMPLEX8, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_0
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:)
!          complex (kind=8), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_1
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:,:)
!          complex (kind=8), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_2
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:,:,:)
!          complex (kind=8), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_3
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:,:,:,:)
!          complex (kind=8), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_4
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:,:,:,:,:)
!          complex (kind=8), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_5
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:,:,:,:,:,:)
!          complex (kind=8), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_6
!
!      subroutine CO_REDUCE_PREDEF_COMPLEX8_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          complex (kind=8) :: source(:,:,:,:,:,:,:)
!          complex (kind=8), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          complex (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), 0, &
!                                                  CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), 0, &
!                                                  CAF_COMPLEX8, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                0, CAF_COMPLEX8, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                0, CAF_COMPLEX8, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_COMPLEX8_7
!
!      !----------------------------------------------------
!      ! reduction wrapper logic - CHARACTER
!      !----------------------------------------------------
!
!      subroutine CO_REDUCE_PREDEF_CHAR_0( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source
!          character (len=*), optional, intent(out) :: result
!          integer, optional, intent(in)  :: result_image
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                              1, len(source), &
!                                              CAF_CHAR, op )
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                              1, len(source), &
!                                              CAF_CHAR, op )
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              result = source
!              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
!                                            len(source), CAF_CHAR, op )
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
!                                            len(source), CAF_CHAR, op )
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_0
!
!      subroutine CO_REDUCE_PREDEF_CHAR_1( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:)
!          character (len=*), optional, intent(out) :: result(:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:)
!          integer :: d1
!
!          d1 = size(result,1)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_1
!
!      subroutine CO_REDUCE_PREDEF_CHAR_2( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:,:)
!          character (len=*), optional, intent(out) :: result(:,:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:,:)
!          integer :: d1,d2
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_2
!
!      subroutine CO_REDUCE_PREDEF_CHAR_3( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:,:,:)
!          character (len=*), optional, intent(out) :: result(:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:,:,:)
!          integer :: d1,d2,d3
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_3
!
!      subroutine CO_REDUCE_PREDEF_CHAR_4( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:,:,:,:)
!          character (len=*), optional, intent(out) :: result(:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:,:,:,:)
!          integer :: d1,d2,d3,d4
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_4
!
!      subroutine CO_REDUCE_PREDEF_CHAR_5( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:,:,:,:,:)
!          character (len=*), optional, intent(out) :: result(:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_5
!
!      subroutine CO_REDUCE_PREDEF_CHAR_6( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:,:,:,:,:,:)
!          character (len=*), optional, intent(out) :: result(:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_6
!
!      subroutine CO_REDUCE_PREDEF_CHAR_7( op, source, result, result_image )
!          use caf_reduction_types
!          implicit none
!          integer :: op
!          character (len=*) :: source(:,:,:,:,:,:,:)
!          character (len=*), optional, intent(out) :: result(:,:,:,:,:,:,:)
!          integer, optional, intent(in)  :: result_image
!
!          character (len=len(source)), allocatable :: contig_src(:,:,:,:,:,:,:)
!          integer :: d1,d2,d3,d4,d5,d6,d7
!
!          d1 = size(result,1)
!          d2 = size(result,2)
!          d3 = size(result,3)
!          d4 = size(result,4)
!          d5 = size(result,5)
!          d6 = size(result,6)
!          d7 = size(result,7)
!
!          if ( present(result) .and. present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to result on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
!                                                  size(result), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result_image) ) then
!              !------------------------------------------------------
!              ! reduce to source on given image
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
!                                                  size(source), len(source), &
!                                                  CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
!                                                  size(contig_src), len(source), &
!                                                  CAF_CHAR, op )
!                  if (this_image() == result_image) source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else if ( present(result) ) then
!              !------------------------------------------------------
!              ! reduce to result on all images
!              !------------------------------------------------------
!
!
!              if (is_contiguous(result)) then
!                  result = source
!                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  result = contig_src
!                  deallocate( contig_src )
!              end if
!
!          else
!              !------------------------------------------------------
!              ! reduce to source on all images
!              !------------------------------------------------------
!
!              if (is_contiguous(source)) then
!                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
!                                                len(source), CAF_CHAR, op )
!              else
!                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
!                  contig_src = source
!                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
!                                                len(source), CAF_CHAR, op )
!                  source = contig_src
!                  deallocate( contig_src )
!              end if
!
!          end if
!
!      end subroutine CO_REDUCE_PREDEF_CHAR_7
