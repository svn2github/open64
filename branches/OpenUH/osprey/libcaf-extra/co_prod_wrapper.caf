              !----------------------------------------------------
              ! reduction wrapper logic - INT1
              !----------------------------------------------------

      subroutine CO_PRODUCT_INT1_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source
          integer (kind=1), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_INT1, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_INT1, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_INT1, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_INT1, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_INT1_0

      subroutine CO_PRODUCT_INT1_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:)
          integer (kind=1), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_1

      subroutine CO_PRODUCT_INT1_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:,:)
          integer (kind=1), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_2

      subroutine CO_PRODUCT_INT1_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:,:,:)
          integer (kind=1), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_3

      subroutine CO_PRODUCT_INT1_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:,:,:,:)
          integer (kind=1), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_4

      subroutine CO_PRODUCT_INT1_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:,:,:,:,:)
          integer (kind=1), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_5

      subroutine CO_PRODUCT_INT1_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:,:,:,:,:,:)
          integer (kind=1), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_6

      subroutine CO_PRODUCT_INT1_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: source(:,:,:,:,:,:,:)
          integer (kind=1), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT1, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT1_7

      !----------------------------------------------------
      ! reduction wrapper logic - INT2
      !----------------------------------------------------

      subroutine CO_PRODUCT_INT2_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source
          integer (kind=2), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_INT2, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_INT2, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_INT2, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_INT2, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_INT2_0

      subroutine CO_PRODUCT_INT2_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:)
          integer (kind=2), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_1

      subroutine CO_PRODUCT_INT2_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:,:)
          integer (kind=2), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_2

      subroutine CO_PRODUCT_INT2_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:,:,:)
          integer (kind=2), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_3

      subroutine CO_PRODUCT_INT2_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:,:,:,:)
          integer (kind=2), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_4

      subroutine CO_PRODUCT_INT2_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:,:,:,:,:)
          integer (kind=2), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_5

      subroutine CO_PRODUCT_INT2_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:,:,:,:,:,:)
          integer (kind=2), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_6

      subroutine CO_PRODUCT_INT2_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: source(:,:,:,:,:,:,:)
          integer (kind=2), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT2, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT2_7

      !----------------------------------------------------
      ! reduction wrapper logic - INT4
      !----------------------------------------------------

      subroutine CO_PRODUCT_INT4_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source
          integer (kind=4), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_INT4, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_INT4, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_INT4, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_INT4, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_INT4_0

      subroutine CO_PRODUCT_INT4_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:)
          integer (kind=4), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_1

      subroutine CO_PRODUCT_INT4_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:,:)
          integer (kind=4), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_2

      subroutine CO_PRODUCT_INT4_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:,:,:)
          integer (kind=4), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_3

      subroutine CO_PRODUCT_INT4_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:,:,:,:)
          integer (kind=4), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_4

      subroutine CO_PRODUCT_INT4_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:,:,:,:,:)
          integer (kind=4), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_5

      subroutine CO_PRODUCT_INT4_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:,:,:,:,:,:)
          integer (kind=4), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_6

      subroutine CO_PRODUCT_INT4_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: source(:,:,:,:,:,:,:)
          integer (kind=4), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT4_7

      !----------------------------------------------------
      ! reduction wrapper logic - INT8
      !----------------------------------------------------

      subroutine CO_PRODUCT_INT8_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source
          integer (kind=8), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_INT8, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_INT8, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_INT8, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_INT8, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_INT8_0

      subroutine CO_PRODUCT_INT8_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:)
          integer (kind=8), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_1

      subroutine CO_PRODUCT_INT8_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:,:)
          integer (kind=8), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_2

      subroutine CO_PRODUCT_INT8_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:,:,:)
          integer (kind=8), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_3

      subroutine CO_PRODUCT_INT8_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:,:,:,:)
          integer (kind=8), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_4

      subroutine CO_PRODUCT_INT8_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:,:,:,:,:)
          integer (kind=8), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_5

      subroutine CO_PRODUCT_INT8_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:,:,:,:,:,:)
          integer (kind=8), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_6

      subroutine CO_PRODUCT_INT8_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: source(:,:,:,:,:,:,:)
          integer (kind=8), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_INT8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_INT8_7

      !----------------------------------------------------
      ! reduction wrapper logic - REAL4
      !----------------------------------------------------

      subroutine CO_PRODUCT_REAL4_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source
          real (kind=4), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_REAL4, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_REAL4, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_REAL4, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_REAL4, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_REAL4_0

      subroutine CO_PRODUCT_REAL4_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:)
          real (kind=4), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_1

      subroutine CO_PRODUCT_REAL4_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:,:)
          real (kind=4), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_2

      subroutine CO_PRODUCT_REAL4_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:,:,:)
          real (kind=4), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_3

      subroutine CO_PRODUCT_REAL4_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:,:,:,:)
          real (kind=4), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_4

      subroutine CO_PRODUCT_REAL4_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:,:,:,:,:)
          real (kind=4), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_5

      subroutine CO_PRODUCT_REAL4_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:,:,:,:,:,:)
          real (kind=4), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_6

      subroutine CO_PRODUCT_REAL4_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: source(:,:,:,:,:,:,:)
          real (kind=4), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL4_7

      !----------------------------------------------------
      ! reduction wrapper logic - REAL8
      !----------------------------------------------------

      subroutine CO_PRODUCT_REAL8_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source
          real (kind=8), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_REAL8, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_REAL8, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_REAL8, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_REAL8, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_REAL8_0

      subroutine CO_PRODUCT_REAL8_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:)
          real (kind=8), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_1

      subroutine CO_PRODUCT_REAL8_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:,:)
          real (kind=8), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_2

      subroutine CO_PRODUCT_REAL8_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:,:,:)
          real (kind=8), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_3

      subroutine CO_PRODUCT_REAL8_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:,:,:,:)
          real (kind=8), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_4

      subroutine CO_PRODUCT_REAL8_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:,:,:,:,:)
          real (kind=8), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_5

      subroutine CO_PRODUCT_REAL8_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:,:,:,:,:,:)
          real (kind=8), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_6

      subroutine CO_PRODUCT_REAL8_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: source(:,:,:,:,:,:,:)
          real (kind=8), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_REAL8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_REAL8_7

      !----------------------------------------------------
      ! reduction wrapper logic - COMPLEX4
      !----------------------------------------------------

      subroutine CO_PRODUCT_COMPLEX4_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source
          complex (kind=4), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_COMPLEX4, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_COMPLEX4, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_COMPLEX4, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_COMPLEX4, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_COMPLEX4_0

      subroutine CO_PRODUCT_COMPLEX4_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:)
          complex (kind=4), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_1

      subroutine CO_PRODUCT_COMPLEX4_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:,:)
          complex (kind=4), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_2

      subroutine CO_PRODUCT_COMPLEX4_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:,:,:)
          complex (kind=4), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_3

      subroutine CO_PRODUCT_COMPLEX4_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:,:,:,:)
          complex (kind=4), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_4

      subroutine CO_PRODUCT_COMPLEX4_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:,:,:,:,:)
          complex (kind=4), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_5

      subroutine CO_PRODUCT_COMPLEX4_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:,:,:,:,:,:)
          complex (kind=4), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_6

      subroutine CO_PRODUCT_COMPLEX4_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=4) :: source(:,:,:,:,:,:,:)
          complex (kind=4), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX4, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX4, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX4, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX4_7

      !----------------------------------------------------
      ! reduction wrapper logic - COMPLEX8
      !----------------------------------------------------

      subroutine CO_PRODUCT_COMPLEX8_0( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source
          complex (kind=8), optional, intent(out) :: result
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              result = source
              call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                              1, 0, &
                                              CAF_COMPLEX8, CAF_PROD )

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                              1, 0, &
                                              CAF_COMPLEX8, CAF_PROD )

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              result = source
              call CO_REDUCE_PREDEF_TO_ALL( result, 1, &
                                            0, CAF_COMPLEX8, CAF_PROD )

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( source, 1, &
                                            0, CAF_COMPLEX8, CAF_PROD )

          end if

      end subroutine CO_PRODUCT_COMPLEX8_0

      subroutine CO_PRODUCT_COMPLEX8_1( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:)
          complex (kind=8), optional, intent(out) :: result(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(source,1)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_1

      subroutine CO_PRODUCT_COMPLEX8_2( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:,:)
          complex (kind=8), optional, intent(out) :: result(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(source,1)
          d2 = size(source,2)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_2

      subroutine CO_PRODUCT_COMPLEX8_3( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:,:,:)
          complex (kind=8), optional, intent(out) :: result(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_3

      subroutine CO_PRODUCT_COMPLEX8_4( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:,:,:,:)
          complex (kind=8), optional, intent(out) :: result(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_4

      subroutine CO_PRODUCT_COMPLEX8_5( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:,:,:,:,:)
          complex (kind=8), optional, intent(out) :: result(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_5

      subroutine CO_PRODUCT_COMPLEX8_6( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:,:,:,:,:,:)
          complex (kind=8), optional, intent(out) :: result(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_6

      subroutine CO_PRODUCT_COMPLEX8_7( source, result, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          complex (kind=8) :: source(:,:,:,:,:,:,:)
          complex (kind=8), optional, intent(out) :: result(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          complex (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(source,1)
          d2 = size(source,2)
          d3 = size(source,3)
          d4 = size(source,4)
          d5 = size(source,5)
          d6 = size(source,6)
          d7 = size(source,7)

          if ( present(result) .and. present(result_image) ) then
              !------------------------------------------------------
              ! reduce to result on given image
              !------------------------------------------------------

              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( result, result_image, &
                                                  size(result), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) result = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to source on given image
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( source, result_image, &
                                                  size(source), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_COMPLEX8, CAF_PROD )
                  if (this_image() == result_image) source = contig_src
                  deallocate( contig_src )
              end if

          else if ( present(result) ) then
              !------------------------------------------------------
              ! reduce to result on all images
              !------------------------------------------------------


              if (is_contiguous(result)) then
                  result = source
                  call CO_REDUCE_PREDEF_TO_ALL( result, size(result), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  result = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to source on all images
              !------------------------------------------------------

              if (is_contiguous(source)) then
                  call CO_REDUCE_PREDEF_TO_ALL( source, size(source), &
                                                0, CAF_COMPLEX8, CAF_PROD )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = source
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_COMPLEX8, CAF_PROD )
                  source = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_PRODUCT_COMPLEX8_7

