      !----------------------------------------------------
      ! reduction wrapper logic - INT1
      !----------------------------------------------------

      subroutine CO_MAX_INT1_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_INT1, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_INT1, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_INT1_0

      subroutine CO_MAX_INT1_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT1_1

      subroutine CO_MAX_INT1_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT1_2

      subroutine CO_MAX_INT1_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT1_3

      subroutine CO_MAX_INT1_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT1_4

      subroutine CO_MAX_INT1_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT1_5

      subroutine CO_MAX_INT1_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT1_6

      subroutine CO_MAX_INT1_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=1) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=1), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT1, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT1, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_INT1_7

      !----------------------------------------------------
      ! reduction wrapper logic - INT2
      !----------------------------------------------------

      subroutine CO_MAX_INT2_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_INT2, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_INT2, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_INT2_0

      subroutine CO_MAX_INT2_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT2_1

      subroutine CO_MAX_INT2_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT2_2

      subroutine CO_MAX_INT2_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT2_3

      subroutine CO_MAX_INT2_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT2_4

      subroutine CO_MAX_INT2_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT2_5

      subroutine CO_MAX_INT2_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT2_6

      subroutine CO_MAX_INT2_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=2) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=2), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT2, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT2, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_INT2_7

      !----------------------------------------------------
      ! reduction wrapper logic - INT4
      !----------------------------------------------------

      subroutine CO_MAX_INT4_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_INT4, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_INT4, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_INT4_0

      subroutine CO_MAX_INT4_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT4_1

      subroutine CO_MAX_INT4_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT4_2

      subroutine CO_MAX_INT4_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT4_3

      subroutine CO_MAX_INT4_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT4_4

      subroutine CO_MAX_INT4_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT4_5

      subroutine CO_MAX_INT4_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT4_6

      subroutine CO_MAX_INT4_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=4) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_INT4_7

      !----------------------------------------------------
      ! reduction wrapper logic - INT8
      !----------------------------------------------------

      subroutine CO_MAX_INT8_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_INT8, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_INT8, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_INT8_0

      subroutine CO_MAX_INT8_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT8_1

      subroutine CO_MAX_INT8_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT8_2

      subroutine CO_MAX_INT8_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT8_3

      subroutine CO_MAX_INT8_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT8_4

      subroutine CO_MAX_INT8_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT8_5

      subroutine CO_MAX_INT8_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_INT8_6

      subroutine CO_MAX_INT8_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          integer (kind=8) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          integer (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_INT8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_INT8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_INT8_7

      !----------------------------------------------------
      ! reduction wrapper logic - REAL4
      !----------------------------------------------------

      subroutine CO_MAX_REAL4_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_REAL4, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_REAL4, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_REAL4_0

      subroutine CO_MAX_REAL4_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL4_1

      subroutine CO_MAX_REAL4_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL4_2

      subroutine CO_MAX_REAL4_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL4_3

      subroutine CO_MAX_REAL4_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL4_4

      subroutine CO_MAX_REAL4_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL4_5

      subroutine CO_MAX_REAL4_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL4_6

      subroutine CO_MAX_REAL4_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=4) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=4), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL4, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL4, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_REAL4_7

      !----------------------------------------------------
      ! reduction wrapper logic - REAL8
      !----------------------------------------------------

      subroutine CO_MAX_REAL8_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_REAL8, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_REAL8, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_REAL8_0

      subroutine CO_MAX_REAL8_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL8_1

      subroutine CO_MAX_REAL8_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL8_2

      subroutine CO_MAX_REAL8_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL8_3

      subroutine CO_MAX_REAL8_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL8_4

      subroutine CO_MAX_REAL8_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL8_5

      subroutine CO_MAX_REAL8_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_REAL8_6

      subroutine CO_MAX_REAL8_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          real (kind=8) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          real (kind=8), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_REAL8, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_REAL8, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_REAL8_7



      !----------------------------------------------------
      ! reduction wrapper logic - CHARACTER
      !----------------------------------------------------

      subroutine CO_MAX_CHAR_0( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                              1, 0, &
                                              CAF_CHAR, CAF_MAX, &
                                              stat, errmsg )

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              call CO_REDUCE_PREDEF_TO_ALL( a, 1, &
                                            0, CAF_CHAR, CAF_MAX, &
                                            stat, errmsg )

          end if

      end subroutine CO_MAX_CHAR_0

      subroutine CO_MAX_CHAR_1( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:)
          integer :: d1

          d1 = size(a,1)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_CHAR_1

      subroutine CO_MAX_CHAR_2( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:,:)
          integer :: d1,d2

          d1 = size(a,1)
          d2 = size(a,2)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_CHAR_2

      subroutine CO_MAX_CHAR_3( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:,:,:)
          integer :: d1,d2,d3

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_CHAR_3

      subroutine CO_MAX_CHAR_4( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:,:,:,:)
          integer :: d1,d2,d3,d4

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_CHAR_4

      subroutine CO_MAX_CHAR_5( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_CHAR_5

      subroutine CO_MAX_CHAR_6( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if

      end subroutine CO_MAX_CHAR_6

      subroutine CO_MAX_CHAR_7( a, result_image, stat, errmsg )
          use caf_reduction_types
          implicit none
          character (len=*) :: a(:,:,:,:,:,:,:)
          integer, optional, intent(in)  :: result_image
          integer, optional, intent(out) :: stat
          character (len=*), optional, intent(out) :: errmsg

          character (len=len(a)), allocatable :: contig_src(:,:,:,:,:,:,:)
          integer :: d1,d2,d3,d4,d5,d6,d7

          d1 = size(a,1)
          d2 = size(a,2)
          d3 = size(a,3)
          d4 = size(a,4)
          d5 = size(a,5)
          d6 = size(a,6)
          d7 = size(a,7)

          if ( present(result_image) ) then
              !------------------------------------------------------
              ! reduce to a on given image
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_IMAGE( a, result_image, &
                                                  size(a), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_IMAGE( contig_src, result_image, &
                                                  size(contig_src), 0, &
                                                  CAF_CHAR, CAF_MAX, &
                                                  stat, errmsg )
                  if (this_image() == result_image) a = contig_src
                  deallocate( contig_src )
              end if

          else
              !------------------------------------------------------
              ! reduce to a on all images
              !------------------------------------------------------

              if (is_contiguous(a)) then
                  call CO_REDUCE_PREDEF_TO_ALL( a, size(a), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
              else
                  allocate( contig_src(d1,d2,d3,d4,d5,d6,d7) )
                  contig_src = a
                  call CO_REDUCE_PREDEF_TO_ALL( contig_src, size(contig_src), &
                                                0, CAF_CHAR, CAF_MAX, &
                                                stat, errmsg )
                  a = contig_src
                  deallocate( contig_src )
              end if

          end if
      end subroutine CO_MAX_CHAR_7

